!function(){"use strict";function e(){try{window.addEventListener("unhandledrejection",function(e){const o=e.reason;if(o&&"object"==typeof o){if(o.message&&o.message.includes("isResetChatHistory"))return console.log("🛡️ CONTENT FIX: Handling isResetChatHistory promise rejection"),window.isResetChatHistory||(window.isResetChatHistory=!1),void e.preventDefault();if(o.message&&o.message.includes("local_folders"))return console.log("🛡️ CONTENT FIX: Handling local_folders promise rejection"),window.local_folders||(window.local_folders=[]),void e.preventDefault();if(o.message&&o.message.includes("storage"))return console.log("🛡️ CONTENT FIX: Handling storage promise rejection"),void e.preventDefault()}console.warn("🛡️ CONTENT FIX: Unhandled promise rejection:",o)}),console.log("✅ CONTENT ERROR HANDLER: Promise rejection handler installed"),function(){const e=window.onerror;window.onerror=function(o,n,r,t,i){if(o&&o.includes("Cannot read properties of undefined")){console.warn("🛡️ CONTENT FIX: Property access error intercepted:",o);const e=o.match(/Cannot read properties of undefined \(reading '(\w+)'\)/);if(e&&e[1]){const o=e[1],n={isResetChatHistory:!1,local_folders:[],conversations:[],userFolders:[],prompts:[],isPremiumUser:!0,isPremium:!0,userPlan:"premium",subscriptionStatus:"active"};n.hasOwnProperty(o)&&!(o in window)&&(window[o]=n[o],console.log(`🛡️ CONTENT FIX: Emergency fallback set for ${o}:`,n[o]))}return!0}return o&&o.includes("Cannot read property")?(console.warn("🛡️ CONTENT FIX: Legacy property access error intercepted:",o),!0):!!e&&e.apply(this,arguments)},console.log("✅ CONTENT ERROR HANDLER: Property error handler installed")}(),void 0===window.isResetChatHistory&&Object.defineProperty(window,"isResetChatHistory",{get:function(){return!1},set:function(e){console.log("🛡️ CONTENT FIX: isResetChatHistory set to:",e),Object.defineProperty(window,"isResetChatHistory",{value:e,writable:!0,enumerable:!0,configurable:!0})},enumerable:!0,configurable:!0}),["local_folders","conversations","userFolders","prompts"].forEach(e=>{window[e]&&Array.isArray(window[e])||(window[e]=[],console.log(`🛡️ CONTENT FIX: Initialized ${e} as empty array`))}),console.log("✅ CONTENT ERROR HANDLER: Content script fixes applied"),console.log("✅ CONTENT ERROR HANDLER: All error handlers initialized successfully")}catch(e){console.error("❌ CONTENT ERROR HANDLER: Initialization failed:",e)}}console.log("🛡️ CONTENT ERROR HANDLER: Initializing comprehensive error handling"),window.safeAccess={get:function(e,o,n=null){try{if(!e||"object"!=typeof e)return console.warn(`🛡️ SAFE ACCESS: Invalid object for path: ${o}`),n;const r=o.split(".");let t=e;for(const e of r){if(null==t)return console.warn(`🛡️ SAFE ACCESS: Null/undefined encountered at key: ${e} in path: ${o}`),n;if(!(e in t))return console.warn(`🛡️ SAFE ACCESS: Key ${e} not found in path: ${o}`),n;t=t[e]}return t}catch(e){return console.warn(`🛡️ SAFE ACCESS: Error accessing path ${o}:`,e),n}},set:function(e,o,n){try{if(!e||"object"!=typeof e)return console.warn(`🛡️ SAFE SET: Invalid object for path: ${o}`),!1;const r=o.split("."),t=r.pop();let i=e;for(const e of r)e in i&&"object"==typeof i[e]||(i[e]={}),i=i[e];return i[t]=n,!0}catch(e){return console.warn(`🛡️ SAFE SET: Error setting path ${o}:`,e),!1}},call:function(e,o,...n){try{return e&&"object"==typeof e?"function"!=typeof e[o]?(console.warn(`🛡️ SAFE CALL: Method ${o} is not a function`),null):e[o].apply(e,n):(console.warn(`🛡️ SAFE CALL: Invalid object for method: ${o}`),null)}catch(e){return console.warn(`🛡️ SAFE CALL: Error calling method ${o}:`,e),null}}},e(),"loading"===document.readyState&&document.addEventListener("DOMContentLoaded",e),window.CONTENT_ERROR_HANDLER_READY=!0}(),console.log("🛡️ CONTENT ERROR HANDLER: Comprehensive error handling system loaded");