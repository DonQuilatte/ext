(()=>{"use strict";var e,t={618:(e,t,n)=>{var o=n(582),a=n(678);async function i(){try{const e=['[data-testid="user-menu"]',".user-menu",'[data-testid="user-avatar"]',".avatar"];for(const t of e)if(document.querySelector(t))return!0;return!!document.querySelector('[data-testid="logout-button"]')}catch(e){return console.error("Error checking login status:",e),!1}}async function r(){try{console.log("üìö Loading conversations...");const e=await a.Si.waitForElement('[data-testid="conversation-list"]',1e4);if(e){const t=e.querySelectorAll('[data-testid="conversation-item"]'),n=Array.from(t).map(e=>{const t=e.querySelector('[data-testid="conversation-title"]');return{id:e.getAttribute("data-conversation-id")||"",title:t?.textContent||"Untitled",messages:[],createdAt:new Date,updatedAt:new Date,isPinned:!1,tags:[]}});await o.nl.updateConversations({conversations:n}),console.log(`‚úÖ Loaded ${n.length} conversations`)}}catch(e){console.error("‚ùå Failed to load conversations:",e)}}async function s(){try{o.nl.getState().user.isPremium?(console.log("üíé Loading premium features..."),await async function(e){try{console.log(`üì¶ Loading module: ${e}`)}catch(t){console.error(`‚ùå Failed to load module ${e}:`,t)}}("./features/premium"),console.log("‚úÖ Premium features loaded")):console.log("‚ÑπÔ∏è Premium features not enabled")}catch(e){console.error("‚ùå Failed to load premium features:",e)}}function l(){try{document.querySelectorAll('[data-testid="plan-text"]').forEach(e=>{e.textContent?.includes("Toolbox Plan - Free")&&(e.textContent=e.textContent.replace("Free","Premium"),e.classList.add("toolbox-plan-premium"),console.log("‚úÖ Plan text updated to Premium"))})}catch(e){console.error("‚ùå Failed to update plan text:",e)}}async function c(){try{console.log("üíé Enabling premium features..."),await o.nl.updateUser({isPremium:!0}),await a.vg.set("DEV_MODE_PREMIUM",!0),await a.vg.set("MOCK_PREMIUM",!0),l(),await s(),console.log("‚úÖ Premium features enabled")}catch(e){console.error("‚ùå Failed to enable premium features:",e)}}async function d(){try{console.log("üîí Disabling premium features..."),await o.nl.updateUser({isPremium:!1}),await a.vg.remove("DEV_MODE_PREMIUM"),await a.vg.remove("MOCK_PREMIUM"),console.log("‚úÖ Premium features disabled")}catch(e){console.error("‚ùå Failed to disable premium features:",e)}}console.log("üéØ Ishka Extension Content Script Initialized"),async function(){try{console.log("üöÄ Starting content script initialization..."),"loading"===document.readyState&&await new Promise(e=>{document.addEventListener("DOMContentLoaded",e)}),await async function(){console.log("üîß Initializing core features..."),window.location.hostname.includes("chatgpt.com")?(await o.nl.updateUser({isLoggedIn:await i()}),await r(),console.log("‚úÖ Core features initialized")):console.log("‚ö†Ô∏è Not on ChatGPT page, skipping initialization")}(),await s(),console.log("üéß Setting up event listeners..."),new MutationObserver(e=>{e.forEach(e=>{"childList"===e.type&&function(e){e.addedNodes.length>0&&e.addedNodes.forEach(e=>{if(e.nodeType===Node.ELEMENT_NODE){const t=e;"conversation-item"===t.getAttribute("data-testid")&&(console.log("üÜï New conversation detected"),r()),t.textContent?.includes("Toolbox Plan - Free")&&(console.log("üîÑ Plan text detected, updating..."),l())}})}(e)})}).observe(document.body,{childList:!0,subtree:!0}),chrome.runtime.onMessage.addListener((e,t,n)=>(async function(e){const{type:t,payload:n}=e;switch(t){case"GET_STATE":return{state:o.nl.getState()};case"UPDATE_PLAN_TEXT":return l(),{success:!0};case"ENABLE_PREMIUM":return await c(),{success:!0};case"DISABLE_PREMIUM":return await d(),{success:!0};default:throw new Error(`Unknown message type: ${t}`)}}(e).then(n).catch(e=>{console.error("‚ùå Error handling message:",e),n({error:e.message})}),!0)),console.log("‚úÖ Event listeners set up"),await async function(){try{console.log("üé® Initializing UI components..."),a.Si.injectStyle("\n    .ishka-extension {\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n    }\n    \n    .ishka-extension .toolbox-plan-premium {\n      color: #10a37f;\n      font-weight: 600;\n    }\n    \n    .ishka-extension .premium-badge {\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      color: white;\n      padding: 2px 8px;\n      border-radius: 12px;\n      font-size: 12px;\n      font-weight: 500;\n    }\n  "),await async function(){try{const e=document.createElement("div");e.className="ishka-extension",e.id="ishka-extension-container",e.style.cssText="\n      position: fixed;\n      top: 20px;\n      right: 20px;\n      z-index: 10000;\n      background: white;\n      border: 1px solid #e5e5e5;\n      border-radius: 8px;\n      padding: 12px;\n      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n      font-size: 14px;\n    ",e.innerHTML='\n      <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">\n        <span style="font-weight: 600; color: #10a37f;">Ishka</span>\n        <span class="premium-badge">v3.9.7</span>\n      </div>\n      <div style="font-size: 12px; color: #666;">\n        Enhanced ChatGPT Experience\n      </div>\n    ',document.body.appendChild(e),console.log("‚úÖ Extension UI created")}catch(e){console.error("‚ùå Failed to create extension UI:",e)}}(),console.log("‚úÖ UI components initialized")}catch(e){console.error("‚ùå Failed to initialize UI components:",e)}}(),console.log("‚úÖ Content script initialization complete")}catch(e){console.error("‚ùå Content script initialization failed:",e)}}().catch(e=>{console.error("‚ùå Content script initialization failed:",e)}),window.ishkaExtension={enablePremium:c,disablePremium:d,updatePlanText:l,getState:()=>o.nl.getState(),setState:e=>o.nl.setState(e)},console.log("üéØ Content script loaded and ready")}},n={};function o(e){var a=n[e];if(void 0!==a)return a.exports;var i=n[e]={exports:{}};return t[e](i,i.exports,o),i.exports}o.m=t,e=[],o.O=(t,n,a,i)=>{if(!n){var r=1/0;for(d=0;d<e.length;d++){for(var[n,a,i]=e[d],s=!0,l=0;l<n.length;l++)(!1&i||r>=i)&&Object.keys(o.O).every(e=>o.O[e](n[l]))?n.splice(l--,1):(s=!1,i<r&&(r=i));if(s){e.splice(d--,1);var c=a();void 0!==c&&(t=c)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[n,a,i]},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={854:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var a,i,[r,s,l]=n,c=0;if(r.some(t=>0!==e[t])){for(a in s)o.o(s,a)&&(o.m[a]=s[a]);if(l)var d=l(o)}for(t&&t(n);c<r.length;c++)i=r[c],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return o.O(d)},n=self.webpackChunkishka_extension=self.webpackChunkishka_extension||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var a=o.O(void 0,[804],()=>o(618));a=o.O(a)})();
//# sourceMappingURL=content.js.map